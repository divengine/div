# Release v3.7.0
Date: 2013-03-30

## Description

- Added new variable's modifiers:

  {&&var} - rawurlencode
  {'var} - escape unescaped single quotes
  {js:var} - escape quotes and backslashes, newlines, etc.
  {$var:[string format]} - format the value with sprintf PHP function

- Added new feature for programmers: custom variable's modifier

  For add a new custom variable's modifier you need call the method:

  div::addCustomModifier($prefix, $function)

  The parameter $function can be the name of function or the name of static method of a class, for example

  div::addCustomModifier('upper', 'MyModifiers::upper');

  Example:
  ----------------
  index.php

  <?php

  function urlpathinfo($value){
  	return str_replace("%2F", "/", rawurlencode($value));
  }

  div::addCustomModifier('upi:', 'urlpathinfo');

  echo new div('index.tpl',array('url' => 'http://localhost'));

  ?>

  index.tpl
  -----------

  {upi:url}


  Output
  -----------
  http%3A//localhost

- Added new feature for programmers: the hooks!. The hooks are:

    beforeBuild, afterBuild, beforeParse, afterParse

    Example:

    index.php
    ---------------
    class HomePage extends div{

    	public function beforeBuild(){
    		$this->__src = "index";
    		$this->setItem(array(
    			"title" => "Hello World"
    		));
    	}
    }

    echo new HomePage();

    index.tpl
    ---------------
    <h1>{$title}</h1>

    Output
    ----------------
    <h1>Hello World</h1>

- Improvement of the setItem method



- Added a new feature for programmers: the method changeTemplate()

	<?php

	include "div.php";

	$tpl = new div('index.tpl', array("title" => "Hello world"));

	echo $tpl; // $tpl->show();

	$tpl->changeTemplate('index2.tpl');

	echo $tpl; // $tpl->show();

	?>

- Improvement of the show() method with a new parameter: specific template

  <?php

  include "div.php";

  $tpl = new div();
  $tpl->title = "Hello world";
  $tpl->show('template.tpl');

  ?>


- Some functions of PHP are enabled in formulas and conditions.

- Added a new system var named: $div.ascii. This var contain the all chars of ASCII table.

  <?php

  include 'div.php';

  div::enableSystemVar('div.ascii');

  ?>

  index.tpl
  -----------
  {$div.ascii.64}

  is similar to

  (# chr(64) #)

  but the replacement is faster than calculation

  Output:
  -------
  @

  is similar to

  @

  but the replacement is faster than calculation



- From version 3.6 Div maintains a policy regarding the use of objects: if an
object has implemented the method __ toString then be treated as a character string.
We are working to improve the policy and avoid unhappy.

	index.php

	<?php

	include "div.php";

	class Product{
		public function __construct($name, $price){
			$this->name = $name;
			$this->price = $price;
		}

		public function __toString(){
			return $this->name.' ($'.$this->price.')';
		}
	}

	echo new div('index.tpl', array("products" => array(new Product('Banana', 10))));
	?>

	index.tpl

	[$products]
		{$value}
	[/$products]

	Output
	Banana ($10)

	We are working to improve the policy and avoid unhappy.


- Improvement of the speed.
- Improvement of the options arround the __toString method of objects in 3 scopes. See the example below.

  The old policy:

  "if an object has implemented the method __toString then be treated as a string"

  It was changed for:

  "if an object has implemented the method __toString, you can work with the object as a character string"


  Example:

    index.php
    ---------
    <?php

	include "div.php";

	class Product{
		public function __construct($name, $price){
			$this->name = $name;
			$this->price = $price;
		}

		public function __toString(){
			return $this->name.' ($'.$this->price.')';
		}
	}

	// The object as string
	echo new div('index.tpl', array("product" => new Product('Banana', 10)));

	// Template scope
	echo new div('index1.tpl', array(new Product('Banana', 10)));

	// Capsule scope
	echo new div('index2.tpl', array("product" => new Product('Banana', 10)));

	// Loop's body scope
	echo new div('index3.tpl', array("products" => array(new Product('Banana', 10))));

    ?>

  	index.tpl
  	------------
  	{$product}

    Output for index.tpl
    --------------------
    Banana ($10)

    index1.tpl
    ----------
	{$value}

	is similar to

    {$_to_string}

    index2.tpl
    ----------
    [[product

    {$value}

	is similar to

    {$_to_string}

    product]]

    index3.tpl
    ----------
    [$products]
	{$value}

	is similar to

	{$_to_string}
    [/$products]

    Same output for index1, index2 and index3
    -------------
    Banana ($10)

    is similar to

    Banana ($10)


- Improved the interpretation of third parameter of the constructor
  as a string with the variables's names.

  echo new div('index.tpl', array('name' => 'Peter', 'age' => 25, 'sex' => 'M'), 'name,age');

- Release the 3.7 version



## Commits
- No commits found.
