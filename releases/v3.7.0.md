# Release v3.7.0

Date: 2013-03-30

## Description

March 30, 2013

- Improved the interpretation of third parameter of the constructor as a string with the variables's names.

echo new div('index.tpl', array('name' => 'Peter', 'age' => 25, 'sex' => 'M'), 'name,age');

- Release the 3.7 version

March 26, 2013

- Improvement of the speed.
- Improvement of the options around the __toString method of objects in 3 scopes. See the example below.

The old policy:

"if an object has implemented the method __toString then be treated as a string"

It was changed for:

"if an object has implemented the method __toString, you can work with the object as a character string"

Example:

index.php

```php
<?php

include "div.php";

class Product{
    public function __construct($name, $price){
        $this->name = $name;
        $this->price = $price;
    }

    public function __toString(){
        return $this->name.' ($'.$this->price.')';
    }
}

// The object as string
echo new div('index.tpl', array("product" => new Product('Banana', 10)));

// Template scope
echo new div('index1.tpl', array(new Product('Banana', 10)));

// Capsule scope
echo new div('index2.tpl', array("product" => new Product('Banana', 10)));

// Loop's body scope
echo new div('index3.tpl', array("products" => array(new Product('Banana', 10))));

?>

```

index.tpl

```div
{$product}

```

Output for index.tpl

```div
Banana ($10)

```

index1.tpl

```div
{$value}

```

is similar to

```div
{$_to_string}

```

index2.tpl

```div
[[product

{$value}

```

is similar to

```div
{$_to_string}

```

product]]

index3.tpl

```div
   [$products]
{$value}

```

is similar to

```div
{$_to_string}
   [/$products]
       
```

Same output for index1, index2 and index3

Banana ($10)

is similar to

Banana ($10)

March 24, 2013

- From version 3.6 Div maintains a policy regarding the use of objects: if an object has implemented the method __ toString then be treated as a character string. We are working to improve the policy and avoid unhappy.

index.php

```php
<?php

include "div.php";

class Product{
    public function __construct($name, $price){
        $this->name = $name;
        $this->price = $price;
    }

    public function __toString(){
        return $this->name.' ($'.$this->price.')';
    }
}

echo new div('index.tpl', array("products" => array(new Product('Banana', 10))));
?>

```

index.tpl

```div
[$products]
    {$value}
[/$products]

```

Output

```div
Banana ($10)

We are working to improve the policy and avoid unhappy.

```

March 22, 2013

- Some functions of PHP are enabled in formulas and conditions.

- Added a new system var named: $div.ascii. This var contain the all chars of ASCII table.

```php
<?php

include 'div.php';

div::enableSystemVar('div.ascii');

?>

```

index.tpl

```div
{$div.ascii.64}

```

is similar to

```div
(# chr(64) #)

```

but the replacement is faster than calculation

Output:

```div
@

```

is similar to

```div
@

```

but the replacement is faster than calculation

March 20, 2013

- Added a new feature for programmers: the method changeTemplate()

```php
<?php

include "div.php";

$tpl = new div('index.tpl', array("title" => "Hello world"));

echo $tpl; // $tpl->show();

$tpl->changeTemplate('index2.tpl');

echo $tpl; // $tpl->show();

?>

```

- Improvement of the show() method with a new parameter: specific template

```php
<?php

include "div.php";

$tpl = new div();
$tpl->title = "Hello world";
$tpl->show('template.tpl');

?>

```

March 18, 2013

- Added new variable's modifiers:

```div
{&&var} - rawurlencode
{'var} - escape unescaped single quotes
{js:var} - escape quotes and backslashes, newlines, etc.
{$var:[string format]} - format the value with sprintf PHP function

```

- Added new feature for programmers: custom variable's modifier

For add a new custom variable's modifier you need call the method:

```div
div::addCustomModifier($prefix, $function)

```

The parameter $function can be the name of function or the name of static method of a class, for example

div::addCustomModifier('upper', 'MyModifiers::upper');

Example:

index.php

```php
<?php

function urlpathinfo($value){
    return str_replace("%2F", "/", rawurlencode($value));
}

div::addCustomModifier('upi:', 'urlpathinfo');

echo new div('index.tpl',array('url' => 'http://localhost'));

?>

```

index.tpl

```div
{upi:url}

```

Output

```div
http%3A//localhost

```

- Added new feature for programmers: the hooks!. The hooks are:

beforeBuild, afterBuild, beforeParse, afterParse

Example:

index.php

class HomePage extends div{

public function beforeBuild(){

```div
        $this->__src = "index";
        $this->setItem(array(
            "title" => "Hello World"
        ));
    }
}

echo new HomePage();

```

index.tpl

```html
<h1>{$title}</h1>

```

Output

```html
<h1>Hello World</h1>

```

- Improvement of the setItem method

## Commits

- No commits found.
