# 2.32 Template's variables

Template variables let designers define derived values inside a template. Values can be:

- A string
- Another variable
- A JSON object or array
- A method call on the current PHP class
- A JSON file path

**Important**: If the value is not valid JSON, it is parsed as template code before JSON decoding. This allows you to build JSON dynamically.

Example sequence:

```
1. Not valid JSON: {= digits: [[:0,8:]{$value},[/]9] =}
2. Parsed value:   {= digits: [0,1,2,3,4,5,6,7,8,9] =}
3. digits is array
4. Replacement:    {$digits}  <!-- OUTPUT "10" -->
```

In contrast:

```
1. Valid JSON:    {= digits: "[[:0,8:]{$value},[/]9]" =}
2. Not parsed
3. digits is string
4. Replacement:  {$digits} <!-- OUTPUT "[0,1,2,3,4,5,6,7,8,9]" -->
```

**Syntax**

```
{= varname: ... value ... =}

{= varname: some string here =}

{= varname: [item1, item2, ...] =}

{= varname: {
    prop1: value1,
    prop2: value2
} =}

{= var1: value1 =}
{= var2: $var1 =}

{= sum: ->sum(20,30) =}
```

Note: the `$` used inside template variable values (for example `{= var2: $var1 =}`) is a fixed token and is not affected by dialect changes. Changing `DIV_TAG_MODIFIER_SIMPLE` only affects replacements in template output.

**Example**

index.php

```php
echo new div('index.tpl', [
    'price' => 40
]);
```

index.tpl

```
{= price: 20 =}

Price: {$price}

{= labels: ['A','B','C','D'] =}

Labels: [$labels] {$value}!$_is_last, $_is_last! [/$labels]

{= product: {
    name: "Potato",
    price: 45
} =}

Product: {$product.name}
Product's price: {$product.price}

{= somestring: Blah blah blah =}

String: {$somestring}

{= somevar: $price =}

Some var: {$somevar}
```

Output

```
Price: 40

Labels: A, B, C, D

Product's price: Potato

Price: 45

String: Blah blah blah

Some var: 40
```

## 6.32.1 Protected template variables

To protect a template variable, prefix it with `*`:

```
{= *protectedvar: "protected value" =}
```

A protected variable cannot be overwritten later.

## 6.32.2 Loading external template content into a variable

```
{= varname: {% external-template %} =}
```

External content is loaded on demand during the first replacement.
